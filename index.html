<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>StudySet - A Quizlet Clone</title>
    <meta name="description" content="Create and master your flashcards with SM-2 spaced repetition">
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800&display=swap" rel="stylesheet">
    <link
        href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined:opsz,wght,FILL,GRAD@20..48,100..700,0..1,-50..200"
        rel="stylesheet">
    <style>
        body {
            font-family: 'Inter', sans-serif;
        }

        .material-symbols-outlined {
            font-variation-settings: 'FILL' 0, 'wght' 400, 'GRAD' 0, 'opsz' 24;
        }

        .material-symbols-outlined.filled {
            font-variation-settings: 'FILL' 1, 'wght' 400, 'GRAD' 0, 'opsz' 24;
        }

        /* Flashcard Flip Animation */
        .flashcard-container {
            perspective: 1000px;
        }

        .flashcard-inner {
            position: relative;
            width: 100%;
            height: 100%;
            transition: transform 0.6s;
            transform-style: preserve-3d;
        }

        .flashcard-container.flipped .flashcard-inner {
            transform: rotateY(180deg);
        }

        .flashcard-front,
        .flashcard-back {
            position: absolute;
            width: 100%;
            height: 100%;
            backface-visibility: hidden;
            display: flex;
            align-items: center;
            justify-content: center;
            padding: 2rem;
            text-align: center;
        }

        .flashcard-back {
            transform: rotateY(180deg);
        }

        /* Progress Bar Animation */
        @keyframes progressPulse {
            0% {
                background-position: 0% 50%;
            }

            50% {
                background-position: 100% 50%;
            }

            100% {
                background-position: 0% 50%;
            }
        }

        .progress-animating {
            background: linear-gradient(270deg, #22c55e, #4f46e5, #22c55e) !important;
            background-size: 200% 200% !important;
            animation: progressPulse 1s ease infinite;
        }

        /* Feedback Colors */
        .feedback-correct {
            background-color: #dcfce7 !important;
            border-color: #16a34a !important;
            color: #14532d !important;
        }

        .feedback-incorrect {
            background-color: #fee2e2 !important;
            border-color: #dc2626 !important;
            color: #7f1d1d !important;
        }

        /* Dictionary Popup */
        .dictionary-popup {
            position: fixed;
            background: white;
            border: 1px solid #e2e8f0;
            box-shadow: 0 10px 25px -5px rgba(0, 0, 0, 0.1);
            padding: 12px 16px;
            border-radius: 12px;
            z-index: 1000;
            max-width: 300px;
            font-size: 0.875rem;
        }

        /* Speaker Animation */
        @keyframes pulseRing {
            0% {
                transform: scale(0.95);
                box-shadow: 0 0 0 0 rgba(79, 70, 229, 0.5);
            }

            70% {
                transform: scale(1);
                box-shadow: 0 0 0 8px rgba(79, 70, 229, 0);
            }

            100% {
                transform: scale(0.95);
                box-shadow: 0 0 0 0 rgba(79, 70, 229, 0);
            }
        }

        .speaking {
            animation: pulseRing 1.5s ease-in-out infinite;
            color: #4f46e5 !important;
        }

        /* Modal Overlay */
        .modal-overlay {
            background-color: rgba(15, 23, 42, 0.6);
            backdrop-filter: blur(4px);
        }

        /* Toggle Switch */
        .toggle-checkbox:checked {
            right: 0;
            border-color: #4f46e5;
        }

        .toggle-checkbox:checked+.toggle-label {
            background-color: #4f46e5;
        }

        .toggle-checkbox {
            right: 50%;
            border-color: #cbd5e1;
        }

        /* Line clamp */
        .line-clamp-2 {
            display: -webkit-box;
            -webkit-line-clamp: 2;
            line-clamp: 2;
            -webkit-box-orient: vertical;
            overflow: hidden;
        }

        /* Contenteditable focus */
        [contenteditable]:focus {
            outline: 2px solid #818cf8;
            outline-offset: 2px;
            border-radius: 4px;
        }

        /* Clickable word hover */
        .clickable-word:hover {
            background-color: rgba(99, 102, 241, 0.1);
            color: #4f46e5;
        }
    </style>
</head>

<body class="bg-slate-50 text-slate-800 min-h-screen">

    <!-- ============================================================ -->
    <!-- HOME SECTION -->
    <!-- ============================================================ -->
    <section id="homeSection" class="min-h-screen">
        <div class="container mx-auto p-4 md:p-8 max-w-6xl">
            <!-- Header -->
            <header class="flex items-center justify-between mb-8">
                <div id="homeStats" class="flex items-center gap-4 text-sm text-slate-500">
                    <!-- Stats injected by JS -->
                </div>
                <div class="text-center">
                    <h1
                        class="text-3xl md:text-4xl font-extrabold bg-gradient-to-r from-indigo-600 to-purple-600 bg-clip-text text-transparent">
                        StudySet
                    </h1>
                    <p class="text-slate-500 text-sm mt-1">Master your flashcards</p>
                </div>
                <div class="flex items-center gap-2">
                    <div id="micIndicator" class="text-slate-300 p-2 cursor-help" title="Free voices (browser)">
                        <span class="material-symbols-outlined">mic</span>
                    </div>
                    <button id="homeSettingsBtn"
                        class="p-2 text-slate-400 hover:text-slate-600 hover:bg-slate-100 rounded-lg transition-colors"
                        aria-label="Settings">
                        <span class="material-symbols-outlined">settings</span>
                    </button>
                    <button id="homeCreateSetBtn"
                        class="flex items-center gap-2 bg-indigo-600 text-white font-semibold py-2 px-4 rounded-lg hover:bg-indigo-700 transition-all hover:scale-105 shadow-md">
                        <span class="material-symbols-outlined">add</span>
                        Create Set
                    </button>
                </div>
            </header>

            <!-- Quick Actions -->
            <div id="homeQuickActions" class="hidden flex flex-wrap gap-3 mb-8">
                <button id="quickActionStudy"
                    class="flex items-center gap-2 bg-green-500 text-white font-medium py-2 px-4 rounded-lg hover:bg-green-600 transition-all">
                    <span class="material-symbols-outlined">timer</span>
                    Study 5 min
                </button>
                <button id="quickActionDue"
                    class="flex items-center gap-2 bg-orange-500 text-white font-medium py-2 px-4 rounded-lg hover:bg-orange-600 transition-all disabled:bg-slate-300">
                    <span class="material-symbols-outlined">schedule</span>
                    Review Due (<span class="due-count">0</span>)
                </button>
                <button id="quickActionRandom"
                    class="flex items-center gap-2 bg-purple-500 text-white font-medium py-2 px-4 rounded-lg hover:bg-purple-600 transition-all">
                    <span class="material-symbols-outlined">shuffle</span>
                    Random Set
                </button>
            </div>

            <!-- Resume Section -->
            <div id="homeResumeSection" class="hidden mb-8">
                <h2 class="text-lg font-semibold text-slate-700 mb-3 flex items-center gap-2">
                    <span class="material-symbols-outlined text-indigo-600">bookmark</span>
                    Pick up where you left off
                </h2>
                <button id="homeResumeCard"
                    class="w-full bg-white p-5 rounded-xl shadow-md border border-slate-200 hover:border-indigo-400 hover:shadow-lg transition-all text-left">
                    <!-- Content injected by JS -->
                </button>
            </div>

            <!-- All Sets Grid -->
            <div>
                <h2 class="text-lg font-semibold text-slate-700 mb-4 flex items-center gap-2">
                    <span class="material-symbols-outlined text-indigo-600">library_books</span>
                    Your Study Sets
                </h2>
                <div id="homeSetGrid" class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-4">
                    <!-- Set cards injected by JS -->
                </div>
            </div>
        </div>
    </section>

    <!-- ============================================================ -->
    <!-- SET VIEW SECTION -->
    <!-- ============================================================ -->
    <section id="setViewSection" class="hidden min-h-screen">
        <div class="container mx-auto p-4 md:p-8 max-w-4xl">
            <!-- Header -->
            <header class="flex items-center justify-between mb-6">
                <button id="setViewBackBtn"
                    class="flex items-center gap-1 text-slate-500 hover:text-slate-700 transition-colors"
                    aria-label="Back">
                    <span class="material-symbols-outlined">arrow_back</span>
                    <span class="hidden sm:inline">Back</span>
                </button>
                <h1 id="setViewTitle" class="text-2xl font-bold text-slate-900 truncate max-w-md"></h1>
                <button id="setViewDeleteBtn"
                    class="p-2 text-slate-400 hover:text-red-500 hover:bg-red-50 rounded-lg transition-colors"
                    aria-label="Delete Set">
                    <span class="material-symbols-outlined">delete</span>
                </button>
            </header>

            <!-- Flashcard Carousel -->
            <div class="bg-white rounded-2xl shadow-lg p-6 mb-6">
                <div id="noCardsMessage" class="hidden text-center py-12 text-slate-400">
                    <span class="material-symbols-outlined text-5xl mb-3">style</span>
                    <p>No cards yet. Add some to see the flashcard preview!</p>
                </div>

                <div class="flex items-center justify-center gap-4">
                    <button id="flashcardPrev"
                        class="p-3 text-slate-400 hover:text-indigo-600 hover:bg-indigo-50 rounded-full transition-colors"
                        aria-label="Previous">
                        <span class="material-symbols-outlined text-3xl">arrow_back</span>
                    </button>

                    <div id="flashcard" class="flashcard-container w-full max-w-lg h-64 cursor-pointer" role="button"
                        aria-label="Click to flip">
                        <div
                            class="flashcard-inner bg-gradient-to-br from-indigo-50 to-slate-100 rounded-xl shadow-inner border border-slate-200">
                            <div id="flashcardFront" class="flashcard-front text-2xl font-semibold text-slate-800">
                            </div>
                            <div id="flashcardBack"
                                class="flashcard-back text-lg text-slate-600 bg-gradient-to-br from-slate-100 to-indigo-50 rounded-xl">
                            </div>
                        </div>
                    </div>

                    <button id="flashcardNext"
                        class="p-3 text-slate-400 hover:text-indigo-600 hover:bg-indigo-50 rounded-full transition-colors"
                        aria-label="Next">
                        <span class="material-symbols-outlined text-3xl">arrow_forward</span>
                    </button>
                </div>

                <div class="flex items-center justify-center gap-4 mt-4">
                    <span id="flashcardCounter" class="text-sm text-slate-500 font-medium">0 / 0</span>
                    <button id="flashcardShuffle"
                        class="p-2 text-slate-400 hover:text-indigo-600 hover:bg-indigo-50 rounded-lg transition-colors"
                        aria-label="Shuffle">
                        <span class="material-symbols-outlined">shuffle</span>
                    </button>
                    <button id="flashcardSpeak"
                        class="p-2 text-slate-400 hover:text-indigo-600 hover:bg-indigo-50 rounded-lg transition-colors"
                        aria-label="Listen">
                        <span class="material-symbols-outlined">volume_up</span>
                    </button>
                </div>
            </div>

            <!-- Action Buttons -->
            <div class="flex flex-wrap gap-3 mb-6">
                <button id="setViewLearnBtn"
                    class="flex-1 flex items-center justify-center gap-2 bg-green-500 text-white font-semibold py-3 px-6 rounded-lg hover:bg-green-600 transition-all hover:scale-[1.02] shadow-md disabled:bg-slate-300 disabled:cursor-not-allowed disabled:shadow-none">
                    <span class="material-symbols-outlined">school</span>
                    Learn All (<span id="setViewCardCount">0</span>)
                </button>
                <button id="setViewStarredBtn"
                    class="flex items-center justify-center gap-2 bg-yellow-400 text-yellow-900 font-semibold py-3 px-5 rounded-lg hover:bg-yellow-500 transition-all hover:scale-[1.02] disabled:bg-slate-200 disabled:text-slate-400 disabled:cursor-not-allowed">
                    <span class="material-symbols-outlined">star</span>
                    Starred (<span id="setViewStarredCount">0</span>)
                </button>
                <button id="setViewDueBtn"
                    class="flex items-center justify-center gap-2 bg-orange-500 text-white font-semibold py-3 px-5 rounded-lg hover:bg-orange-600 transition-all hover:scale-[1.02] disabled:bg-slate-200 disabled:text-slate-400 disabled:cursor-not-allowed">
                    <span class="material-symbols-outlined">schedule</span>
                    Due (<span class="due-count" id="setViewDueCount">0</span>)
                </button>
            </div>

            <!-- Add Cards Row -->
            <div class="flex gap-3 mb-6">
                <button id="setViewAddCardBtn"
                    class="flex items-center gap-2 bg-indigo-600 text-white font-semibold py-2 px-4 rounded-lg hover:bg-indigo-700 transition-all shadow-sm">
                    <span class="material-symbols-outlined">add</span>
                    Add Card
                </button>
                <button id="bulkImportBtn"
                    class="flex items-center gap-2 bg-slate-200 text-slate-700 font-medium py-2 px-4 rounded-lg hover:bg-slate-300 transition-all">
                    <span class="material-symbols-outlined">upload</span>
                    Bulk Import
                </button>
            </div>

            <!-- Term List -->
            <div>
                <h2 class="text-lg font-semibold text-slate-700 mb-4 flex items-center gap-2">
                    <span class="material-symbols-outlined text-indigo-600">list</span>
                    Terms in this set
                </h2>
                <div id="setViewTermList" class="space-y-3">
                    <!-- Terms injected by JS -->
                </div>
            </div>
        </div>
    </section>

    <!-- ============================================================ -->
    <!-- LEARN MODE SECTION -->
    <!-- ============================================================ -->
    <section id="learnSection" class="hidden min-h-screen bg-gradient-to-b from-slate-100 to-slate-50">
        <div class="container mx-auto p-4 md:p-6 max-w-3xl">
            <!-- Header -->
            <header class="flex items-center justify-between mb-6">
                <button id="learnExitBtn"
                    class="flex items-center gap-1 text-slate-500 hover:text-slate-700 transition-colors"
                    aria-label="Exit">
                    <span class="material-symbols-outlined">close</span>
                    <span class="hidden sm:inline">Exit</span>
                </button>
                <h2 class="text-lg font-semibold text-slate-700">Learn Mode</h2>
                <button id="learnSettingsBtn"
                    class="p-2 text-slate-400 hover:text-slate-600 hover:bg-white rounded-lg transition-colors"
                    aria-label="Learn Settings">
                    <span class="material-symbols-outlined">settings</span>
                </button>
            </header>

            <!-- Progress Bar -->
            <div class="mb-8">
                <div class="flex justify-between mb-2">
                    <span class="text-sm font-medium text-slate-600">Progress</span>
                    <span id="progressText" class="text-sm font-medium text-slate-600">0 / 0</span>
                </div>
                <div class="w-full bg-slate-200 rounded-full h-3 shadow-inner">
                    <div id="progressBar"
                        class="bg-gradient-to-r from-indigo-500 to-purple-500 h-3 rounded-full transition-all duration-500"
                        style="width: 0%"></div>
                </div>
            </div>

            <!-- Question Content -->
            <div id="learnContent" class="bg-white rounded-2xl shadow-lg p-6">
                <!-- Question -->
                <div
                    class="bg-gradient-to-br from-slate-50 to-slate-100 p-6 rounded-xl mb-6 min-h-[140px] flex items-center border border-slate-200">
                    <button id="speakBtn"
                        class="mr-6 text-slate-400 hover:text-indigo-600 flex-shrink-0 transition-colors p-3 rounded-full hover:bg-white"
                        aria-label="Listen">
                        <span class="material-symbols-outlined text-3xl">volume_up</span>
                    </button>
                    <div class="flex-grow text-center">
                        <p id="questionText" class="text-xl text-slate-800 leading-relaxed"></p>
                    </div>
                </div>

                <!-- Grade Buttons (SM-2) -->
                <div id="gradeButtons" class="hidden flex gap-3">
                    <!-- Buttons injected by JS -->
                </div>

                <!-- Multiple Choice (non-SM2) -->
                <div id="answerOptions" class="grid grid-cols-1 md:grid-cols-2 gap-4">
                    <!-- Options injected by JS -->
                </div>
            </div>

            <!-- Feedback Section -->
            <div id="feedbackSection" class="hidden bg-white rounded-2xl shadow-lg p-6 mt-6 text-center">
                <h3 id="feedbackTitle" class="text-xl font-bold"></h3>
                <p id="feedbackText" class="mt-2 text-slate-600"></p>
                <button id="nextQuestionBtn"
                    class="mt-6 bg-indigo-600 text-white font-semibold py-3 px-8 rounded-lg hover:bg-indigo-700 transition-all shadow-md">
                    Next
                </button>
            </div>

            <!-- Summary Screen -->
            <div id="summaryScreen" class="hidden bg-white rounded-2xl shadow-lg p-8 mt-6 text-center">
                <button id="continueBtn"
                    class="bg-indigo-600 text-white font-semibold py-3 px-8 rounded-lg hover:bg-indigo-700 mb-8 shadow-lg transition-all hover:scale-105">
                    Continue Learning
                </button>
                <h2 class="text-2xl font-bold text-slate-800 mb-2">Batch Complete!</h2>
                <p class="text-slate-500 mb-6">Here's how you did on the last 10 questions.</p>
                <div class="flex justify-center gap-12 mb-6">
                    <div>
                        <span id="summaryCorrect" class="text-4xl font-bold text-green-500">0</span>
                        <p class="text-slate-500">Correct</p>
                    </div>
                    <div>
                        <span id="summaryMissed" class="text-4xl font-bold text-red-500">0</span>
                        <p class="text-slate-500">Missed</p>
                    </div>
                </div>
                <div id="summaryList" class="text-left max-h-64 overflow-y-auto"></div>
            </div>

            <!-- Completion Screen -->
            <div id="completionScreen" class="hidden bg-white rounded-2xl shadow-lg p-8 text-center">
                <span class="material-symbols-outlined text-7xl text-green-500 mb-4">celebration</span>
                <h2 class="text-3xl font-bold text-green-600 mb-4">Congratulations!</h2>
                <p class="text-lg text-slate-600 mb-8">You've mastered all the cards in this session.</p>
                <div class="flex flex-col sm:flex-row gap-4 justify-center">
                    <button id="restartLearnBtn"
                        class="bg-indigo-600 text-white font-semibold py-3 px-6 rounded-lg hover:bg-indigo-700 transition-all shadow-md">
                        Restart Session
                    </button>
                    <button id="backToSetBtn"
                        class="bg-slate-200 text-slate-700 font-semibold py-3 px-6 rounded-lg hover:bg-slate-300 transition-all">
                        Back to Set
                    </button>
                </div>
            </div>
        </div>
    </section>

    <!-- ============================================================ -->
    <!-- MODALS -->
    <!-- ============================================================ -->

    <!-- Create Set Modal -->
    <div id="createSetModal" class="fixed inset-0 z-50 hidden flex items-center justify-center p-4">
        <div class="modal-overlay absolute inset-0"></div>
        <div class="relative bg-white rounded-2xl shadow-2xl p-6 w-full max-w-md">
            <div class="flex justify-between items-center mb-4">
                <h2 class="text-xl font-bold text-slate-800">Create New Set</h2>
                <button id="createSetCloseBtn"
                    class="p-1 text-slate-400 hover:text-slate-600 rounded-lg hover:bg-slate-100">
                    <span class="material-symbols-outlined">close</span>
                </button>
            </div>
            <form id="createSetForm">
                <input type="text" id="createSetNameInput" placeholder="Set name..."
                    class="w-full p-3 border border-slate-300 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500 mb-4"
                    required>
                <button type="submit"
                    class="w-full bg-indigo-600 text-white font-semibold py-3 rounded-lg hover:bg-indigo-700 transition-colors shadow-md">
                    Create Set
                </button>
            </form>
        </div>
    </div>

    <!-- Add Card Modal -->
    <div id="addCardModal" class="fixed inset-0 z-50 hidden flex items-center justify-center p-4">
        <div class="modal-overlay absolute inset-0"></div>
        <div class="relative bg-white rounded-2xl shadow-2xl p-6 w-full max-w-md">
            <div class="flex justify-between items-center mb-4">
                <h2 class="text-xl font-bold text-slate-800">Add Card</h2>
                <button id="addCardCloseBtn"
                    class="p-1 text-slate-400 hover:text-slate-600 rounded-lg hover:bg-slate-100">
                    <span class="material-symbols-outlined">close</span>
                </button>
            </div>
            <form id="addCardForm">
                <div class="mb-4">
                    <label for="addCardTermInput" class="block text-sm font-medium text-slate-600 mb-1">Term</label>
                    <input type="text" id="addCardTermInput" placeholder="e.g., Photosynthesis"
                        class="w-full p-3 border border-slate-300 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500"
                        required>
                </div>
                <div class="mb-4">
                    <label for="addCardDefInput"
                        class="block text-sm font-medium text-slate-600 mb-1">Definition</label>
                    <textarea id="addCardDefInput" rows="3" placeholder="e.g., Process plants use to convert light..."
                        class="w-full p-3 border border-slate-300 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500"
                        required></textarea>
                </div>
                <button type="submit"
                    class="w-full bg-indigo-600 text-white font-semibold py-3 rounded-lg hover:bg-indigo-700 transition-colors shadow-md">
                    Add Card
                </button>
            </form>
        </div>
    </div>

    <!-- Bulk Import Modal -->
    <div id="bulkImportModal" class="fixed inset-0 z-50 hidden flex items-center justify-center p-4">
        <div class="modal-overlay absolute inset-0"></div>
        <div class="relative bg-white rounded-2xl shadow-2xl p-6 w-full max-w-lg max-h-[90vh] overflow-y-auto">
            <div class="flex justify-between items-center mb-4">
                <h2 class="text-xl font-bold text-slate-800">Bulk Import Cards</h2>
                <button id="bulkImportCloseBtn"
                    class="p-1 text-slate-400 hover:text-slate-600 rounded-lg hover:bg-slate-100">
                    <span class="material-symbols-outlined">close</span>
                </button>
            </div>
            <div class="space-y-4">
                <div>
                    <label for="importDelimiter" class="block text-sm font-medium text-slate-600 mb-1">Delimiter</label>
                    <select id="importDelimiter"
                        class="w-full p-3 border border-slate-300 rounded-lg focus:ring-2 focus:ring-indigo-500 bg-white">
                        <option value="auto">Auto-Detect</option>
                        <option value=":">Colon (:)</option>
                        <option value=";">Semicolon (;)</option>
                        <option value=",">Comma (,)</option>
                        <option value="tab">Tab</option>
                        <option value="newline">Newline (alternating lines)</option>
                    </select>
                </div>
                <div>
                    <label for="importText" class="block text-sm font-medium text-slate-600 mb-1">Paste Data</label>
                    <textarea id="importText" rows="10"
                        placeholder="Photosynthesis: Process plants use...&#10;Mitochondria: Powerhouse of cell..."
                        class="w-full p-3 border border-slate-300 rounded-lg focus:ring-2 focus:ring-indigo-500 font-mono text-sm"></textarea>
                </div>
                <button id="importBtn"
                    class="w-full flex items-center justify-center gap-2 bg-indigo-600 text-white font-semibold py-3 rounded-lg hover:bg-indigo-700 transition-colors shadow-md">
                    <span class="material-symbols-outlined">upload</span>
                    Import Cards
                </button>
            </div>
        </div>
    </div>

    <!-- Settings Modal -->
    <div id="settingsModal" class="fixed inset-0 z-50 hidden flex items-center justify-center p-4">
        <div class="modal-overlay absolute inset-0"></div>
        <div class="relative bg-white rounded-2xl shadow-2xl p-8 w-full max-w-md">
            <div class="flex justify-between items-center mb-6">
                <h2 class="text-2xl font-bold text-slate-800">Settings</h2>
                <button id="closeSettingsBtn"
                    class="p-1 text-slate-400 hover:text-slate-600 rounded-lg hover:bg-slate-100">
                    <span class="material-symbols-outlined">close</span>
                </button>
            </div>

            <div class="space-y-6">
                <!-- Auto Read -->
                <div class="flex items-center justify-between">
                    <label for="settingAutoRead" class="font-medium text-slate-700">Auto-read questions</label>
                    <div class="relative inline-block w-12 align-middle select-none">
                        <input type="checkbox" id="settingAutoRead"
                            class="toggle-checkbox absolute block w-6 h-6 rounded-full bg-white border-4 appearance-none cursor-pointer transition-all duration-200" />
                        <label for="settingAutoRead"
                            class="toggle-label block overflow-hidden h-6 rounded-full bg-slate-300 cursor-pointer"></label>
                    </div>
                </div>

                <hr class="border-slate-200">

                <!-- Premium TTS -->
                <div>
                    <div class="flex items-center justify-between mb-4">
                        <label for="settingUsePremium" class="font-medium text-slate-700 flex items-center gap-2">
                            Premium voices
                            <span
                                class="text-xs bg-gradient-to-r from-yellow-400 to-orange-400 text-white px-2 py-0.5 rounded-full font-bold">PRO</span>
                        </label>
                        <div class="relative inline-block w-12 align-middle select-none">
                            <input type="checkbox" id="settingUsePremium"
                                class="toggle-checkbox absolute block w-6 h-6 rounded-full bg-white border-4 appearance-none cursor-pointer transition-all duration-200" />
                            <label for="settingUsePremium"
                                class="toggle-label block overflow-hidden h-6 rounded-full bg-slate-300 cursor-pointer"></label>
                        </div>
                    </div>

                    <div id="premiumSettingsContainer" class="hidden pl-4 border-l-2 border-indigo-200 space-y-4">
                        <p class="text-sm text-slate-500">Ultra-realistic voices powered by ElevenLabs.</p>
                        <div>
                            <label for="elevenLabsKey" class="block text-sm font-medium text-slate-700 mb-1">API
                                Key</label>
                            <input type="password" id="elevenLabsKey" placeholder="sk_..."
                                class="w-full p-2 border border-slate-300 rounded-lg focus:ring-2 focus:ring-indigo-500 text-sm">
                            <p class="text-xs text-slate-400 mt-1">
                                <a href="https://elevenlabs.io" target="_blank"
                                    class="text-indigo-600 hover:underline">Get your key â†’</a>
                            </p>
                        </div>
                        <div>
                            <label for="voiceSelector"
                                class="block text-sm font-medium text-slate-700 mb-1">Voice</label>
                            <select id="voiceSelector"
                                class="w-full p-2 border border-slate-300 rounded-lg focus:ring-2 focus:ring-indigo-500 text-sm">
                                <option value="21m00Tcm4TlvDq8ikWAM">Rachel (Warm)</option>
                                <option value="ErXwobaYiN019PkySvjV">Antoni (Clear)</option>
                                <option value="AZnzlk1XvdvUeBnXmlld">Domi (Strong)</option>
                                <option value="EXAVITQu4vr4xnSDxMaL">Bella (Soft)</option>
                            </select>
                        </div>
                    </div>
                </div>
            </div>

            <button id="saveSettingsBtn"
                class="w-full mt-8 bg-indigo-600 text-white font-semibold py-3 rounded-lg hover:bg-indigo-700 transition-colors shadow-md">
                Save Settings
            </button>
        </div>
    </div>

    <!-- Learn Settings Modal -->
    <div id="learnSettingsModal" class="fixed inset-0 z-50 hidden flex items-center justify-center p-4">
        <div class="modal-overlay absolute inset-0"></div>
        <div class="relative bg-white rounded-2xl shadow-2xl p-6 w-full max-w-md">
            <div class="flex justify-between items-center mb-6">
                <h2 class="text-xl font-bold text-slate-800">Learn Settings</h2>
                <button id="learnSettingsCloseBtn"
                    class="p-1 text-slate-400 hover:text-slate-600 rounded-lg hover:bg-slate-100">
                    <span class="material-symbols-outlined">close</span>
                </button>
            </div>

            <div class="space-y-4">
                <!-- SM-2 Toggle -->
                <div class="flex items-center justify-between p-3 bg-slate-50 rounded-lg">
                    <div>
                        <label for="settingSM2" class="font-medium text-slate-700">Spaced Repetition (SM-2)</label>
                        <p class="text-xs text-slate-500">Optimize review timing for better retention</p>
                    </div>
                    <div class="relative inline-block w-12 align-middle select-none">
                        <input type="checkbox" id="settingSM2" checked
                            class="toggle-checkbox absolute block w-6 h-6 rounded-full bg-white border-4 appearance-none cursor-pointer transition-all duration-200" />
                        <label for="settingSM2"
                            class="toggle-label block overflow-hidden h-6 rounded-full bg-slate-300 cursor-pointer"></label>
                    </div>
                </div>

                <hr class="border-slate-200">

                <!-- Export/Import -->
                <div class="flex gap-3">
                    <button id="exportSetBtn"
                        class="flex-1 flex items-center justify-center gap-2 bg-slate-100 text-slate-700 font-medium py-3 rounded-lg hover:bg-slate-200 transition-colors">
                        <span class="material-symbols-outlined">download</span>
                        Export JSON
                    </button>
                    <button id="importSetBtn"
                        class="flex-1 flex items-center justify-center gap-2 bg-slate-100 text-slate-700 font-medium py-3 rounded-lg hover:bg-slate-200 transition-colors">
                        <span class="material-symbols-outlined">upload</span>
                        Import JSON
                    </button>
                </div>

                <hr class="border-slate-200">

                <!-- Keyboard Settings -->
                <button id="keyboardSettingsBtn"
                    class="w-full flex items-center justify-between p-3 bg-slate-50 rounded-lg hover:bg-slate-100 transition-colors">
                    <div class="flex items-center gap-3">
                        <span class="material-symbols-outlined text-slate-600">keyboard</span>
                        <span class="font-medium text-slate-700">Keyboard Shortcuts</span>
                    </div>
                    <span class="material-symbols-outlined text-slate-400">chevron_right</span>
                </button>
            </div>
        </div>
    </div>

    <!-- Keyboard Settings Modal -->
    <div id="keyboardSettingsModal" class="fixed inset-0 z-50 hidden flex items-center justify-center p-4">
        <div class="modal-overlay absolute inset-0"></div>
        <div class="relative bg-white rounded-2xl shadow-2xl p-6 w-full max-w-md max-h-[90vh] overflow-y-auto">
            <div class="flex justify-between items-center mb-6">
                <h2 class="text-xl font-bold text-slate-800">Keyboard Shortcuts</h2>
                <button id="keyboardSettingsCloseBtn"
                    class="p-1 text-slate-400 hover:text-slate-600 rounded-lg hover:bg-slate-100">
                    <span class="material-symbols-outlined">close</span>
                </button>
            </div>

            <div class="space-y-3">
                <div class="flex items-center justify-between">
                    <label class="text-sm text-slate-600">Flip Card</label>
                    <input type="text" data-key="flip" data-default="Space" value="Space"
                        class="w-24 p-2 text-center border border-slate-300 rounded-lg text-sm font-mono">
                </div>
                <div class="flex items-center justify-between">
                    <label class="text-sm text-slate-600">Previous Card</label>
                    <input type="text" data-key="prev" data-default="ArrowLeft" value="ArrowLeft"
                        class="w-24 p-2 text-center border border-slate-300 rounded-lg text-sm font-mono">
                </div>
                <div class="flex items-center justify-between">
                    <label class="text-sm text-slate-600">Next Card</label>
                    <input type="text" data-key="next" data-default="ArrowRight" value="ArrowRight"
                        class="w-24 p-2 text-center border border-slate-300 rounded-lg text-sm font-mono">
                </div>
                <hr class="border-slate-200 my-4">
                <div class="flex items-center justify-between">
                    <label class="text-sm text-slate-600">Grade: Again</label>
                    <input type="text" data-key="grade1" data-default="1" value="1"
                        class="w-24 p-2 text-center border border-slate-300 rounded-lg text-sm font-mono">
                </div>
                <div class="flex items-center justify-between">
                    <label class="text-sm text-slate-600">Grade: Hard</label>
                    <input type="text" data-key="grade2" data-default="2" value="2"
                        class="w-24 p-2 text-center border border-slate-300 rounded-lg text-sm font-mono">
                </div>
                <div class="flex items-center justify-between">
                    <label class="text-sm text-slate-600">Grade: Good</label>
                    <input type="text" data-key="grade3" data-default="3" value="3"
                        class="w-24 p-2 text-center border border-slate-300 rounded-lg text-sm font-mono">
                </div>
                <div class="flex items-center justify-between">
                    <label class="text-sm text-slate-600">Grade: Easy</label>
                    <input type="text" data-key="grade4" data-default="4" value="4"
                        class="w-24 p-2 text-center border border-slate-300 rounded-lg text-sm font-mono">
                </div>
                <hr class="border-slate-200 my-4">
                <div class="flex items-center justify-between">
                    <label class="text-sm text-slate-600">Toggle Star</label>
                    <input type="text" data-key="star" data-default="s" value="s"
                        class="w-24 p-2 text-center border border-slate-300 rounded-lg text-sm font-mono">
                </div>
                <div class="flex items-center justify-between">
                    <label class="text-sm text-slate-600">Listen (TTS)</label>
                    <input type="text" data-key="listen" data-default="l" value="l"
                        class="w-24 p-2 text-center border border-slate-300 rounded-lg text-sm font-mono">
                </div>
            </div>

            <button id="saveKeyBindingsBtn"
                class="w-full mt-6 bg-indigo-600 text-white font-semibold py-3 rounded-lg hover:bg-indigo-700 transition-colors shadow-md">
                Save Shortcuts
            </button>
        </div>
    </div>

    <!-- ES Module Script -->
    <script type="module" src="src/app.js"></script>
</body>

</html>